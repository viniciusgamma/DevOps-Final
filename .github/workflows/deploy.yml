name: CI + Deploy Flask para Render

on:
  push:
    branches:
      - main

jobs:
  build:
    name: ğŸ”§ Build da AplicaÃ§Ã£o
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout do CÃ³digo
        uses: actions/checkout@v3

      - name: ğŸ—ï¸ Construindo Imagem Docker
        run: docker build -t flask-app .

  test:
    name: ğŸ§ª Executar Testes
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: ğŸ“¥ Checkout do CÃ³digo
        uses: actions/checkout@v3

      - name: ğŸ§± Build para Testes
        run: docker build -t flask-app .

      - name: ğŸ” Rodando Testes
        run: docker run --rm flask-app python testes.py

  deploy:
    name: ğŸš€ Deploy para Render
    runs-on: ubuntu-latest
    needs: test
    steps:
      - name: ğŸ“¡ Disparar Deploy na Render
        run: |
          curl -X POST "https://api.render.com/deploy/srv-d0vobsjipnbc7384dppg?key=nBtT9GS3FUQ"
